
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../logistic_regression/">
      
      
        <link rel="next" href="../mlp/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Logistic regression - EIS Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logistic-regression" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EIS Toolkit" class="md-header__button md-logo" aria-label="EIS Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EIS Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Logistic regression
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GispoCoding/eis_toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eis_toolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EIS Toolkit" class="md-nav__button md-logo" aria-label="EIS Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EIS Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GispoCoding/eis_toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eis_toolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dependency_licenses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependency licenses
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Conversions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Conversions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversions/csv_to_geodataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert csv to geodataframe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conversions/raster_to_dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert raster to dataframe
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/calculate_base_metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calculate base metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/classification_label_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification label evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/classification_probability_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification probability evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/plot_confusion_matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot confusion matrix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/plot_nn_model_performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot neural network training performance (accuracy and loss)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/plot_prediction_area_curves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot prediction-area (P-A) curves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/plot_rate_curve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot rate curve
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exploratory analyses
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Exploratory analyses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/chi_square_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chi-square test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/correlation_matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Correlation matrix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/covariance_matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Covariance matrix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/dbscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DBSCAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/descriptive_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descriptive statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/feature_importance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature importance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/k_means_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K-means clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/local_morans_i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Moran's I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/normality_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normality test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/parallel_coordinates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot parallel coordinates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/pca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PCA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prediction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Prediction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fuzzy_overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fuzzy overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gradient_boosting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradient boosting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logistic_regression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logistic regression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Logistic regression
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Logistic regression
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general" class="md-nav__link">
    <span class="md-ellipsis">
      machine_learning_general
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.prepare_data_for_ml" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data_for_ml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.read_data_for_evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      read_data_for_evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.reshape_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      reshape_predictions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.save_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mlp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MLP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../random_forests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random forests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weights_of_evidence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weights of evidence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Raster processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Raster processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/clipping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clipping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/create_constant_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create constant raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/distance_to_anomaly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distance to anomaly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/extract_values_from_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract values from raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/reclassify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reclassify raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/reprojecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reprojecting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/resampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resampling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/snapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/unifying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unifying
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/unique_combinations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unique combinations in rasters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/windowing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windowing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_12" >
        
          
          <label class="md-nav__link" for="__nav_7_12" id="__nav_7_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Derivatives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_12">
            <span class="md-nav__icon md-icon"></span>
            Derivatives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/derivatives/classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/derivatives/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/derivatives/partial_derivatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partial derivatives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/derivatives/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_13" >
        
          
          <label class="md-nav__link" for="__nav_7_13" id="__nav_7_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Filters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_13">
            <span class="md-nav__icon md-icon"></span>
            Filters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/filters/focal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Focal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/filters/kernels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kernels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/filters/speckle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speckle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/filters/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Training data tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Training data tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../training_data_tools/class_balancing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Class balancing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transformations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Transformations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/binarize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binarize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/clip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/linear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/logarithmic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logarithmic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/one_hot_encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    One-hot encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/sigmoid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sigmoid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/winsorize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Winsorize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_8" >
        
          
          <label class="md-nav__link" for="__nav_9_8" id="__nav_9_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Coda
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_8">
            <span class="md-nav__icon md-icon"></span>
            Coda
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/coda/alr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Additive logratio transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/coda/clr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Centered logratio transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/coda/ilr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Isometric logratio transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/coda/pairwise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pairwise logratio transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/coda/plr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pivot logratio transform
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/file_io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File I/O utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/nodata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodata utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Raster data utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vector processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Vector processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/calculate_geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calculate geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/cell_based_association/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cell-Based Association
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/distance_computation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distance computation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/extract_shared_lines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract shared lines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/idw_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/kriging_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kriging interpolation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/rasterize_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rasterize vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/reproject_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reproject vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/vector_density/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector density
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general" class="md-nav__link">
    <span class="md-ellipsis">
      machine_learning_general
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.prepare_data_for_ml" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data_for_ml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.read_data_for_evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      read_data_for_evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.reshape_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      reshape_predictions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.save_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.machine_learning_general.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="logistic-regression">Logistic regression</h1>


<div class="doc doc-object doc-module">



<a id="eis_toolkit.prediction.machine_learning_general"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.load_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_model</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load a Sklearn model from a .joblib file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path from where the model should be loaded. Include the .joblib file extension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Loaded model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseEstimator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a Sklearn model from a .joblib file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path from where the model should be loaded. Include the .joblib file extension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Loaded model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.prepare_data_for_ml" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_data_for_ml</span><span class="p">(</span><span class="n">feature_raster_files</span><span class="p">,</span> <span class="n">label_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prepare data ready for machine learning model training.</p>
<p>Performs the following steps:
- Read all bands of all feature/evidence rasters into a stacked Numpy array
- Read label data (and rasterize if a vector file is given)
- Create a nodata mask using all feature rasters and labels, and mask nodata cells out</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>feature_raster_files</code></td>
          <td>
                <code><span title="beartype.typing.Sequence">Sequence</span>[<span title="beartype.typing.Union">Union</span>[str, <span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of filepaths of feature/evidence rasters. Files should only include
raster that have the same grid properties and extent.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>label_file</code></td>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[<span title="beartype.typing.Union">Union</span>[str, <span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filepath to label (deposits) data. File can be either a vector file or raster file.
If a vector file is provided, it will be rasterized into similar grid as feature rasters. If
a raster file is provided, it needs to have same grid properties and extent as feature rasters.
Optional parameter and can be omitted if preparing data for predicting. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Feature data (X) in prepared shape.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target labels (y) in prepared shape (if <code>label_file</code> was given).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="rasterio.profiles.Profile">Profile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Refrence raster metadata .</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="beartype.typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Nodata mask applied to X and y.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="eis_toolkit.exceptions.InvalidDatasetException">InvalidDatasetException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input feature rasters contains only one path.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="eis_toolkit.exceptions.NonMatchingRasterMetadataException">NonMatchingRasterMetadataException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input feature rasters, and optionally rasterized label file,
don't have same grid properties.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">prepare_data_for_ml</span><span class="p">(</span>
    <span class="n">feature_raster_files</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">]],</span>
    <span class="n">label_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">Profile</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare data ready for machine learning model training.</span>

<span class="sd">    Performs the following steps:</span>
<span class="sd">    - Read all bands of all feature/evidence rasters into a stacked Numpy array</span>
<span class="sd">    - Read label data (and rasterize if a vector file is given)</span>
<span class="sd">    - Create a nodata mask using all feature rasters and labels, and mask nodata cells out</span>

<span class="sd">    Args:</span>
<span class="sd">        feature_raster_files: List of filepaths of feature/evidence rasters. Files should only include</span>
<span class="sd">            raster that have the same grid properties and extent.</span>
<span class="sd">        label_file: Filepath to label (deposits) data. File can be either a vector file or raster file.</span>
<span class="sd">            If a vector file is provided, it will be rasterized into similar grid as feature rasters. If</span>
<span class="sd">            a raster file is provided, it needs to have same grid properties and extent as feature rasters.</span>
<span class="sd">            Optional parameter and can be omitted if preparing data for predicting. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Feature data (X) in prepared shape.</span>
<span class="sd">        Target labels (y) in prepared shape (if `label_file` was given).</span>
<span class="sd">        Refrence raster metadata .</span>
<span class="sd">        Nodata mask applied to X and y.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidDatasetException: Input feature rasters contains only one path.</span>
<span class="sd">        NonMatchingRasterMetadataException: Input feature rasters, and optionally rasterized label file,</span>
<span class="sd">            don&#39;t have same grid properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_read_and_stack_feature_raster</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read all bands of raster file with feature/evidence data in a stack.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">raster_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">profile</span>
        <span class="k">return</span> <span class="n">raster_data</span><span class="p">,</span> <span class="n">profile</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_raster_files</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidDatasetException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected more than one feature raster file: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_raster_files</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Read and stack feature rasters</span>
    <span class="n">feature_data</span><span class="p">,</span> <span class="n">profiles</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">_read_and_stack_feature_raster</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">feature_raster_files</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_raster_grids</span><span class="p">(</span><span class="n">profiles</span><span class="p">,</span> <span class="n">same_extent</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">NonMatchingRasterMetadataException</span><span class="p">(</span><span class="s2">&quot;Input feature rasters should have same grid properties.&quot;</span><span class="p">)</span>

    <span class="n">reference_profile</span> <span class="o">=</span> <span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nodata_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">profile</span><span class="p">[</span><span class="s2">&quot;nodata&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>

    <span class="c1"># Reshape feature rasters for ML and create mask</span>
    <span class="n">reshaped_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nodata_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">raster</span><span class="p">,</span> <span class="n">nodata</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">feature_data</span><span class="p">,</span> <span class="n">nodata_values</span><span class="p">):</span>
        <span class="n">raster_reshaped</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">raster</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">reshaped_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">raster_reshaped</span><span class="p">)</span>

        <span class="n">nan_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">raster_reshaped</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">combined_mask</span> <span class="o">=</span> <span class="n">nan_mask</span> <span class="k">if</span> <span class="n">nodata_mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">nodata_mask</span> <span class="o">|</span> <span class="n">nan_mask</span>

        <span class="k">if</span> <span class="n">nodata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">raster_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">raster_reshaped</span> <span class="o">==</span> <span class="n">nodata</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">combined_mask</span> <span class="o">=</span> <span class="n">combined_mask</span> <span class="o">|</span> <span class="n">raster_mask</span>

        <span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">combined_mask</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">reshaped_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check label file type and process accordingly</span>
        <span class="n">file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">label_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># Labels/deposits in vector format</span>
        <span class="k">if</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;.gpkg&quot;</span><span class="p">]:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rasterize_vector</span><span class="p">(</span><span class="n">geodataframe</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">label_file</span><span class="p">),</span> <span class="n">raster_profile</span><span class="o">=</span><span class="n">reference_profile</span><span class="p">)</span>

        <span class="c1"># Labels/deposits in raster format</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">label_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">label_raster</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">label_raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Assuming labels are in the first band</span>
                <span class="n">label_nodata</span> <span class="o">=</span> <span class="n">label_raster</span><span class="o">.</span><span class="n">nodata</span>
                <span class="n">profiles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span>
                <span class="n">profiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label_raster</span><span class="o">.</span><span class="n">profile</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">check_raster_grids</span><span class="p">(</span><span class="n">profiles</span><span class="p">,</span> <span class="n">same_extent</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">NonMatchingRasterMetadataException</span><span class="p">(</span>
                        <span class="s2">&quot;Label raster should have the same grid properties as feature rasters.&quot;</span>
                    <span class="p">)</span>

            <span class="n">label_nodata_mask</span> <span class="o">=</span> <span class="n">y</span> <span class="o">==</span> <span class="n">label_nodata</span>

            <span class="c1"># Combine masks and apply to feature and label data</span>
            <span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">nodata_mask</span> <span class="o">|</span> <span class="n">label_nodata_mask</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">reference_profile</span><span class="p">,</span> <span class="n">nodata_mask</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.read_data_for_evaluation" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_data_for_evaluation</span><span class="p">(</span><span class="n">rasters</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prepare data ready for evaluating modeling outputs.</p>
<p>Reads all rasters (only first band), reshapes them (flattens) and masks out all NaN
and nodata pixels by creating a combined mask from all input rasters.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rasters</code></td>
          <td>
                <code><span title="beartype.typing.Sequence">Sequence</span>[<span title="beartype.typing.Union">Union</span>[str, <span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of filepaths of input rasters. Files should only include raster that have
the same grid properties and extent.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="beartype.typing.Sequence">Sequence</span>[<span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of reshaped and masked raster data.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="rasterio.profiles.Profile">Profile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Refrence raster profile.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="beartype.typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Nodata mask applied to raster data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="eis_toolkit.exceptions.InvalidDatasetException">InvalidDatasetException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input rasters contains only one path.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="eis_toolkit.exceptions.NonMatchingRasterMetadataException">NonMatchingRasterMetadataException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input rasters don't have same grid properties.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">read_data_for_evaluation</span><span class="p">(</span>
    <span class="n">rasters</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">Profile</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare data ready for evaluating modeling outputs.</span>

<span class="sd">    Reads all rasters (only first band), reshapes them (flattens) and masks out all NaN</span>
<span class="sd">    and nodata pixels by creating a combined mask from all input rasters.</span>

<span class="sd">    Args:</span>
<span class="sd">        rasters: List of filepaths of input rasters. Files should only include raster that have</span>
<span class="sd">            the same grid properties and extent.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of reshaped and masked raster data.</span>
<span class="sd">        Refrence raster profile.</span>
<span class="sd">        Nodata mask applied to raster data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidDatasetException: Input rasters contains only one path.</span>
<span class="sd">        NonMatchingRasterMetadataException: Input rasters don&#39;t have same grid properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rasters</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidDatasetException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected more than one raster file: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rasters</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">profiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">raster_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nodata_values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">raster</span> <span class="ow">in</span> <span class="n">rasters</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">profile</span>
            <span class="n">profiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
            <span class="n">raster_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">nodata_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nodata&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_raster_grids</span><span class="p">(</span><span class="n">profiles</span><span class="p">,</span> <span class="n">same_extent</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">NonMatchingRasterMetadataException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input rasters should have the same grid properties: </span><span class="si">{</span><span class="n">profiles</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">reference_profile</span> <span class="o">=</span> <span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">nodata_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">nodata</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">raster_data</span><span class="p">,</span> <span class="n">nodata_values</span><span class="p">):</span>
        <span class="n">nan_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">combined_mask</span> <span class="o">=</span> <span class="n">nan_mask</span> <span class="k">if</span> <span class="n">nodata_mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">nodata_mask</span> <span class="o">|</span> <span class="n">nan_mask</span>

        <span class="k">if</span> <span class="n">nodata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">raster_mask</span> <span class="o">=</span> <span class="n">data</span> <span class="o">==</span> <span class="n">nodata</span>
            <span class="n">combined_mask</span> <span class="o">=</span> <span class="n">combined_mask</span> <span class="o">|</span> <span class="n">raster_mask</span>

        <span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">combined_mask</span>
    <span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">nodata_mask</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">masked_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">raster_data</span><span class="p">:</span>
        <span class="n">flattened_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">masked_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flattened_data</span><span class="p">[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">masked_data</span><span class="p">,</span> <span class="n">reference_profile</span><span class="p">,</span> <span class="n">nodata_mask</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.reshape_predictions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reshape_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">nodata_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Reshape 1D prediction ouputs into 2D Numpy array.</p>
<p>The output is ready to be visualized and saved as a raster.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predictions</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A 1D Numpy array with raw prediction data from <code>predict</code> function.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>height</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Height of the output array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of the output array</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nodata_mask</code></td>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Nodata mask used to reconstruct original shape of data. This is the same mask
applied to data before predicting to remove nodata. If any nodata was removed
before predicting, this mask is required to reconstruct the original shape of data.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Predictions as a 2D Numpy array in the original array shape.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">reshape_predictions</span><span class="p">(</span>
    <span class="n">predictions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nodata_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reshape 1D prediction ouputs into 2D Numpy array.</span>

<span class="sd">    The output is ready to be visualized and saved as a raster.</span>

<span class="sd">    Args:</span>
<span class="sd">        predictions: A 1D Numpy array with raw prediction data from `predict` function.</span>
<span class="sd">        height: Height of the output array</span>
<span class="sd">        width: Width of the output array</span>
<span class="sd">        nodata_mask: Nodata mask used to reconstruct original shape of data. This is the same mask</span>
<span class="sd">            applied to data before predicting to remove nodata. If any nodata was removed</span>
<span class="sd">            before predicting, this mask is required to reconstruct the original shape of data.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Predictions as a 2D Numpy array in the original array shape.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_predictions_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nodata_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">full_predictions_array</span><span class="p">[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span> <span class="o">=</span> <span class="n">predictions</span>
    <span class="n">predictions_reshaped</span> <span class="o">=</span> <span class="n">full_predictions_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">predictions_reshaped</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.save_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Save a trained Sklearn model to a .joblib file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Trained model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path where the model should be saved. Include the .joblib file extension.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save a trained Sklearn model to a .joblib file.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Trained model.</span>
<span class="sd">        path: Path where the model should be saved. Include the .joblib file extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="eis_toolkit.prediction.machine_learning_general.split_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">split_data</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">split_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Split data into two parts. Can be used for train-test or train-validation splits.</p>
<p>For more guidance, read documentation of sklearn.model_selection.train_test_split:
(https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*data</code></td>
          <td>
                <code><span title="beartype.typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="pandas.DataFrame">DataFrame</span>, <span title="scipy.sparse._csr.csr_matrix">csr_matrix</span>, <span title="beartype.typing.List">List</span>[<span title="numbers.Number">Number</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data to be split. Multiple datasets can be given as input (for example X and y),
but they need to have the same length. All datasets are split into two and the parts returned
(for example X_train, X_test, y_train, y_test).</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>split_size</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The proportion of the second part of the split. Typically this is the size of test/validation
part. The first part will be complemental proportion. For example, if split_size = 0.2, the first part
will have 80% of the data and the second part 20% of the data. Defaults to 0.2.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>random_state</code></td>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed for random number generation. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If data is shuffled before splitting. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="beartype.typing.List">List</span>[<span title="beartype.typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="pandas.DataFrame">DataFrame</span>, <span title="scipy.sparse._csr.csr_matrix">csr_matrix</span>, <span title="beartype.typing.List">List</span>[<span title="numbers.Number">Number</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List containing splits of inputs (two outputs per input).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/machine_learning_general.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">split_data</span><span class="p">(</span>
    <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">sparse</span><span class="o">.</span><span class="n">_csr</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Number</span><span class="p">]],</span>
    <span class="n">split_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">sparse</span><span class="o">.</span><span class="n">_csr</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Number</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split data into two parts. Can be used for train-test or train-validation splits.</span>

<span class="sd">    For more guidance, read documentation of sklearn.model_selection.train_test_split:</span>
<span class="sd">    (https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html).</span>

<span class="sd">    Args:</span>
<span class="sd">        *data: Data to be split. Multiple datasets can be given as input (for example X and y),</span>
<span class="sd">            but they need to have the same length. All datasets are split into two and the parts returned</span>
<span class="sd">            (for example X_train, X_test, y_train, y_test).</span>
<span class="sd">        split_size: The proportion of the second part of the split. Typically this is the size of test/validation</span>
<span class="sd">            part. The first part will be complemental proportion. For example, if split_size = 0.2, the first part</span>
<span class="sd">            will have 80% of the data and the second part 20% of the data. Defaults to 0.2.</span>
<span class="sd">        random_state: Seed for random number generation. Defaults to None.</span>
<span class="sd">        shuffle: If data is shuffled before splitting. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List containing splits of inputs (two outputs per input).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">split_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">InvalidParameterValueException</span><span class="p">(</span><span class="s2">&quot;Split size must be more than 0 and less than 1.&quot;</span><span class="p">)</span>

    <span class="n">split_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">split_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">split_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made by <a href="info@gispo.fi">Gispo Ltd.</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
    
  </body>
</html>