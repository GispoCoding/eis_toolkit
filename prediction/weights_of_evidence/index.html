
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../fuzzy_overlay/">
      
      
        <link rel="next" href="../../raster_processing/check_raster_grids/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>Weights of evidence - EIS Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#weights-of-evidence" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EIS Toolkit" class="md-header__button md-logo" aria-label="EIS Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EIS Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Weights of evidence
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GispoCoding/eis_toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eis_toolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EIS Toolkit" class="md-nav__button md-logo" aria-label="EIS Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EIS Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GispoCoding/eis_toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    eis_toolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../dependency_licenses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependency licenses
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Conversions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Conversions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../conversions/csv_to_geodataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert csv to geodataframe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../conversions/raster_to_dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert raster to dataframe
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exploratory analyses
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Exploratory analyses
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/dbscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DBSCAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/descriptive_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descriptive statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/feature_importance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature importance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/k_means_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K-means clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/parallel_coordinates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot parallel coordinates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/pca/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PCA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../exploratory_analyses/statistical_testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistical (hypothesis) testing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prediction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Prediction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fuzzy_overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fuzzy overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Weights of evidence
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Weights of evidence
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence" class="md-nav__link">
    weights_of_evidence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_responses" class="md-nav__link">
    weights_of_evidence_calculate_responses()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_weights" class="md-nav__link">
    weights_of_evidence_calculate_weights()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Raster processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Raster processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/check_raster_grids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Check raster grids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/clipping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clipping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/create_constant_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create constant raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/extract_values_from_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract values from raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/reprojecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reprojecting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/resampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resampling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/snapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/unifying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unifying
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../raster_processing/windowing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windowing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Training data tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Training data tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../training_data_tools/class_balancing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Class balancing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transformations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Transformations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/binarize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binarize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/clip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/linear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/logarithmic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logarithmic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/sigmoid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sigmoid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transformations/winsorize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Winsorize
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Validation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Validation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/calculate_auc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calculate AUC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/calculate_base_metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calculate base metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/get_pa_intersection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get P-A plot intersection point
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/plot_correlation_matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot correlation matrix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/plot_prediction_area_curves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot prediction-area (P-A) curves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../validation/plot_rate_curve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot rate curve
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vector processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Vector processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/cell_based_association/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cell-Based Association
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/distance_computation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distance computation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/idw_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IDW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/kriging_interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kriging interpolation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/rasterize_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rasterize vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/reproject_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reproject vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../vector_processing/vector_density/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vector density
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence" class="md-nav__link">
    weights_of_evidence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_responses" class="md-nav__link">
    weights_of_evidence_calculate_responses()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_weights" class="md-nav__link">
    weights_of_evidence_calculate_weights()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="weights-of-evidence">Weights of evidence</h1>


<div class="doc doc-object doc-module">



<a id="eis_toolkit.prediction.weights_of_evidence"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_responses" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">weights_of_evidence_calculate_responses</span><span class="p">(</span><span class="n">output_arrays</span><span class="p">,</span> <span class="n">nr_of_deposits</span><span class="p">,</span> <span class="n">nr_of_pixels</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculate the posterior probabilities for the given generalized weight arrays.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_arrays</code></td>
          <td>
                <code><span title="beartype.typing.Sequence">Sequence</span>[<span title="beartype.typing.Dict">Dict</span>[str, <span title="numpy.ndarray">ndarray</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of output array dictionaries returned by weights of evidence calculations.
For each dictionary, generalized weight and generalized standard deviation arrays are used and summed
together pixel-wise to calculate the posterior probabilities. If generalized arrays are not found,
the W+ and S_W+ arrays are used (so if outputs from unique weight calculations are used for this function).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nr_of_deposits</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of deposit pixels in the input data for weights of evidence calculations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nr_of_pixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of evidence pixels in the input data for weights of evidence calculations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array of posterior probabilites.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array of standard deviations in the posterior probability calculations.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array of confidence of the prospectivity values obtained in the posterior probability array.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/weights_of_evidence.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">weights_of_evidence_calculate_responses</span><span class="p">(</span>
    <span class="n">output_arrays</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span> <span class="n">nr_of_deposits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nr_of_pixels</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the posterior probabilities for the given generalized weight arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_arrays: List of output array dictionaries returned by weights of evidence calculations.</span>
<span class="sd">            For each dictionary, generalized weight and generalized standard deviation arrays are used and summed</span>
<span class="sd">            together pixel-wise to calculate the posterior probabilities. If generalized arrays are not found,</span>
<span class="sd">            the W+ and S_W+ arrays are used (so if outputs from unique weight calculations are used for this function).</span>
<span class="sd">        nr_of_deposits: Number of deposit pixels in the input data for weights of evidence calculations.</span>
<span class="sd">        nr_of_pixels: Number of evidence pixels in the input data for weights of evidence calculations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of posterior probabilites.</span>
<span class="sd">        Array of standard deviations in the posterior probability calculations.</span>
<span class="sd">        Array of confidence of the prospectivity values obtained in the posterior probability array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gen_weights_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">item</span><span class="p">[</span><span class="n">GENERALIZED_WEIGHT_PLUS_COLUMN</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">GENERALIZED_WEIGHT_PLUS_COLUMN</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">else</span> <span class="n">item</span><span class="p">[</span><span class="n">WEIGHT_PLUS_COLUMN</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">output_arrays</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">gen_weights_variance_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">GENERALIZED_S_WEIGHT_PLUS_COLUMN</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">GENERALIZED_S_WEIGHT_PLUS_COLUMN</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="n">WEIGHT_S_PLUS_COLUMN</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">output_arrays</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">prior_probabilities</span> <span class="o">=</span> <span class="n">nr_of_deposits</span> <span class="o">/</span> <span class="n">nr_of_pixels</span>
    <span class="n">prior_odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prior_probabilities</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">prior_probabilities</span><span class="p">))</span>
    <span class="n">posterior_probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gen_weights_sum</span> <span class="o">+</span> <span class="n">prior_odds</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gen_weights_sum</span> <span class="o">+</span> <span class="n">prior_odds</span><span class="p">))</span>

    <span class="n">posterior_probabilities_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">posterior_probabilities</span><span class="p">)</span>
    <span class="n">posterior_probabilities_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">nr_of_deposits</span> <span class="o">+</span> <span class="n">gen_weights_variance_sum</span><span class="p">)</span> <span class="o">*</span> <span class="n">posterior_probabilities_squared</span>
    <span class="p">)</span>

    <span class="n">confidence_array</span> <span class="o">=</span> <span class="n">posterior_probabilities</span> <span class="o">/</span> <span class="n">posterior_probabilities_std</span>
    <span class="k">return</span> <span class="n">posterior_probabilities</span><span class="p">,</span> <span class="n">posterior_probabilities_std</span><span class="p">,</span> <span class="n">confidence_array</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="eis_toolkit.prediction.weights_of_evidence.weights_of_evidence_calculate_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">weights_of_evidence_calculate_weights</span><span class="p">(</span><span class="n">evidential_raster</span><span class="p">,</span> <span class="n">deposits</span><span class="p">,</span> <span class="n">raster_nodata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_type</span><span class="o">=</span><span class="s1">&#39;unique&#39;</span><span class="p">,</span> <span class="n">studentized_contrast_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrays_to_generate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculate weights of spatial associations.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>evidential_raster</code></td>
          <td>
                <code><span title="rasterio.io.DatasetReader">DatasetReader</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The evidential raster.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>deposits</code></td>
          <td>
                <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector data representing the mineral deposits or occurences point data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>raster_nodata</code></td>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[<span title="numbers.Number">Number</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If nodata value of raster is wanted to specify manually. Optional parameter, defaults to None
(nodata from raster metadata is used).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>weights_type</code></td>
          <td>
                <code><span title="beartype.typing.Literal">Literal</span>[unique, categorical, ascending, descending]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Accepted values are 'unique', 'categorical', 'ascending' and 'descending'.
Unique weights does not create generalized classes and does not use a studentized contrast threshold value
while categorical, cumulative ascending and cumulative descending do. Categorical weights are calculated so
that all classes with studentized contrast below the defined threshold are grouped into one generalized
class. Cumulative ascending and descending weights find the class with max contrast and group classes
above/below into generalized classes. Generalized weights are also calculated for generalized classes.</p>
            </div>
          </td>
          <td>
                <code>&#39;unique&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>studentized_contrast_threshold</code></td>
          <td>
                <code><span title="numbers.Number">Number</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Studentized contrast threshold value used with 'categorical', 'ascending' and
'descending' weight types. Used either as reclassification threshold directly (categorical) or to check
that class with max contrast has studentized contrast value at least the defined value (cumulative).
Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>arrays_to_generate</code></td>
          <td>
                <code><span title="beartype.typing.Optional">Optional</span>[<span title="beartype.typing.Sequence">Sequence</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arrays to generate from the computed weight metrics. All column names
in the produced weights_df are valid choices. Defaults to ["Class", "W+", "S_W+]
for "unique" weights_type and ["Class", "W+", "S_W+", "Generalized W+", "Generalized S_W+"]
for the cumulative weight types.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataframe with weights of spatial association between the input data.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of arrays for specified metrics.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Raster metadata.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of deposit pixels.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of all evidence pixels.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>eis_toolkit/prediction/weights_of_evidence.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">weights_of_evidence_calculate_weights</span><span class="p">(</span>
    <span class="n">evidential_raster</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">DatasetReader</span><span class="p">,</span>
    <span class="n">deposits</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span>
    <span class="n">raster_nodata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;unique&quot;</span><span class="p">,</span> <span class="s2">&quot;categorical&quot;</span><span class="p">,</span> <span class="s2">&quot;ascending&quot;</span><span class="p">,</span> <span class="s2">&quot;descending&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;unique&quot;</span><span class="p">,</span>
    <span class="n">studentized_contrast_threshold</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">arrays_to_generate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate weights of spatial associations.</span>

<span class="sd">    Args:</span>
<span class="sd">        evidential_raster: The evidential raster.</span>
<span class="sd">        deposits: Vector data representing the mineral deposits or occurences point data.</span>
<span class="sd">        raster_nodata: If nodata value of raster is wanted to specify manually. Optional parameter, defaults to None</span>
<span class="sd">            (nodata from raster metadata is used).</span>
<span class="sd">        weights_type: Accepted values are &#39;unique&#39;, &#39;categorical&#39;, &#39;ascending&#39; and &#39;descending&#39;.</span>
<span class="sd">            Unique weights does not create generalized classes and does not use a studentized contrast threshold value</span>
<span class="sd">            while categorical, cumulative ascending and cumulative descending do. Categorical weights are calculated so</span>
<span class="sd">            that all classes with studentized contrast below the defined threshold are grouped into one generalized</span>
<span class="sd">            class. Cumulative ascending and descending weights find the class with max contrast and group classes</span>
<span class="sd">            above/below into generalized classes. Generalized weights are also calculated for generalized classes.</span>
<span class="sd">        studentized_contrast_threshold: Studentized contrast threshold value used with &#39;categorical&#39;, &#39;ascending&#39; and</span>
<span class="sd">            &#39;descending&#39; weight types. Used either as reclassification threshold directly (categorical) or to check</span>
<span class="sd">            that class with max contrast has studentized contrast value at least the defined value (cumulative).</span>
<span class="sd">            Defaults to 1.</span>
<span class="sd">        arrays_to_generate: Arrays to generate from the computed weight metrics. All column names</span>
<span class="sd">            in the produced weights_df are valid choices. Defaults to [&quot;Class&quot;, &quot;W+&quot;, &quot;S_W+]</span>
<span class="sd">            for &quot;unique&quot; weights_type and [&quot;Class&quot;, &quot;W+&quot;, &quot;S_W+&quot;, &quot;Generalized W+&quot;, &quot;Generalized S_W+&quot;]</span>
<span class="sd">            for the cumulative weight types.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataframe with weights of spatial association between the input data.</span>
<span class="sd">        Dictionary of arrays for specified metrics.</span>
<span class="sd">        Raster metadata.</span>
<span class="sd">        Number of deposit pixels.</span>
<span class="sd">        Number of all evidence pixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">arrays_to_generate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;unique&quot;</span><span class="p">:</span>
            <span class="n">metrics_to_arrays</span> <span class="o">=</span> <span class="n">DEFAULT_METRICS_UNIQUE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">metrics_to_arrays</span> <span class="o">=</span> <span class="n">DEFAULT_METRICS_CUMULATIVE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">arrays_to_generate</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_DF_COLUMNS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidColumnException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Arrays to generate contains invalid metric / column name: </span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
        <span class="n">metrics_to_arrays</span> <span class="o">=</span> <span class="n">arrays_to_generate</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># 1. Preprocess data</span>
    <span class="n">evidence_array</span> <span class="o">=</span> <span class="n">_read_and_preprocess_evidence</span><span class="p">(</span><span class="n">evidential_raster</span><span class="p">,</span> <span class="n">raster_nodata</span><span class="p">)</span>
    <span class="n">raster_meta</span> <span class="o">=</span> <span class="n">evidential_raster</span><span class="o">.</span><span class="n">meta</span>

    <span class="c1"># Rasterize deposits</span>
    <span class="n">deposit_array</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">rasterize_vector</span><span class="p">(</span>
        <span class="n">geodataframe</span><span class="o">=</span><span class="n">deposits</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">base_raster_profile</span><span class="o">=</span><span class="n">raster_meta</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="p">)</span>

    <span class="c1"># Mask NaN out of the array</span>
    <span class="n">nodata_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">evidence_array</span><span class="p">)</span>
    <span class="n">masked_evidence_array</span> <span class="o">=</span> <span class="n">evidence_array</span><span class="p">[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="p">]</span>
    <span class="n">masked_deposit_array</span> <span class="o">=</span> <span class="n">deposit_array</span><span class="p">[</span><span class="o">~</span><span class="n">nodata_mask</span><span class="p">]</span>

    <span class="c1"># 2. WofE calculations</span>
    <span class="k">if</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;unique&quot;</span> <span class="ow">or</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;categorical&quot;</span><span class="p">:</span>
        <span class="n">wofe_weights</span> <span class="o">=</span> <span class="n">_unique_weights</span><span class="p">(</span><span class="n">masked_deposit_array</span><span class="p">,</span> <span class="n">masked_evidence_array</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;ascending&quot;</span><span class="p">:</span>
        <span class="n">wofe_weights</span> <span class="o">=</span> <span class="n">_cumulative_weights</span><span class="p">(</span><span class="n">masked_deposit_array</span><span class="p">,</span> <span class="n">masked_evidence_array</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;descending&quot;</span><span class="p">:</span>
        <span class="n">wofe_weights</span> <span class="o">=</span> <span class="n">_cumulative_weights</span><span class="p">(</span><span class="n">masked_deposit_array</span><span class="p">,</span> <span class="n">masked_evidence_array</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidParameterValueException</span><span class="p">(</span>
            <span class="s2">&quot;Expected weights_type to be one of unique, categorical, ascending or descending.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># 3. Create DataFrame based on calculated metrics</span>
    <span class="n">df_entries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">wofe_weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)</span> <span class="k">else</span> <span class="n">metric</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">w_plus</span><span class="p">,</span> <span class="n">s_w_plus</span><span class="p">,</span> <span class="n">w_minus</span><span class="p">,</span> <span class="n">s_w_minus</span><span class="p">,</span> <span class="n">contrast</span><span class="p">,</span> <span class="n">s_contrast</span><span class="p">,</span> <span class="n">studentized_contrast</span> <span class="o">=</span> <span class="n">metrics</span>
        <span class="n">df_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">CLASS_COLUMN</span><span class="p">:</span> <span class="bp">cls</span><span class="p">,</span>
                <span class="n">PIXEL_COUNT_COLUMN</span><span class="p">:</span> <span class="n">A</span> <span class="o">+</span> <span class="n">C</span><span class="p">,</span>
                <span class="n">DEPOSIT_COUNT_COLUMN</span><span class="p">:</span> <span class="n">A</span><span class="p">,</span>
                <span class="n">WEIGHT_PLUS_COLUMN</span><span class="p">:</span> <span class="n">w_plus</span><span class="p">,</span>
                <span class="n">WEIGHT_S_PLUS_COLUMN</span><span class="p">:</span> <span class="n">s_w_plus</span><span class="p">,</span>
                <span class="n">WEIGHT_MINUS_COLUMN</span><span class="p">:</span> <span class="n">w_minus</span><span class="p">,</span>
                <span class="n">WEIGHT_S_MINUS_COLUMN</span><span class="p">:</span> <span class="n">s_w_minus</span><span class="p">,</span>
                <span class="n">CONTRAST_COLUMN</span><span class="p">:</span> <span class="n">contrast</span><span class="p">,</span>
                <span class="n">S_CONTRAST_COLUMN</span><span class="p">:</span> <span class="n">s_contrast</span><span class="p">,</span>
                <span class="n">STUDENTIZED_CONTRAST_COLUMN</span><span class="p">:</span> <span class="n">studentized_contrast</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="n">weights_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_entries</span><span class="p">)</span>

    <span class="c1"># 4. If we use cumulative weights type, calculate generalized classes and weights</span>
    <span class="k">if</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;categorical&quot;</span><span class="p">:</span>
        <span class="n">weights_df</span> <span class="o">=</span> <span class="n">_generalized_classes_categorical</span><span class="p">(</span><span class="n">weights_df</span><span class="p">,</span> <span class="n">studentized_contrast_threshold</span><span class="p">)</span>
        <span class="n">weights_df</span> <span class="o">=</span> <span class="n">_generalized_weights_categorical</span><span class="p">(</span><span class="n">weights_df</span><span class="p">,</span> <span class="n">masked_deposit_array</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;ascending&quot;</span> <span class="ow">or</span> <span class="n">weights_type</span> <span class="o">==</span> <span class="s2">&quot;descending&quot;</span><span class="p">:</span>
        <span class="n">weights_df</span> <span class="o">=</span> <span class="n">_generalized_classes_cumulative</span><span class="p">(</span><span class="n">weights_df</span><span class="p">,</span> <span class="n">studentized_contrast_threshold</span><span class="p">)</span>
        <span class="n">weights_df</span> <span class="o">=</span> <span class="n">_generalized_weights_cumulative</span><span class="p">(</span><span class="n">weights_df</span><span class="p">,</span> <span class="n">masked_deposit_array</span><span class="p">)</span>

    <span class="c1"># 5. Generate arrays for desired metrics</span>
    <span class="n">arrays_dict</span> <span class="o">=</span> <span class="n">_generate_arrays_from_metrics</span><span class="p">(</span><span class="n">evidence_array</span><span class="p">,</span> <span class="n">weights_df</span><span class="p">,</span> <span class="n">metrics_to_arrays</span><span class="p">)</span>

    <span class="c1"># Return nr. of deposit pixels  and nr. of all evidence pixels for to be used in calculate responses</span>
    <span class="n">nr_of_deposits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masked_deposit_array</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">nr_of_pixels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">masked_evidence_array</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">weights_df</span><span class="p">,</span> <span class="n">arrays_dict</span><span class="p">,</span> <span class="n">raster_meta</span><span class="p">,</span> <span class="n">nr_of_deposits</span><span class="p">,</span> <span class="n">nr_of_pixels</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made by <a href="info@gispo.fi">Gispo Ltd.</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>